---
title: "p8105_hw2_tk2886"
author: "Tanvir Khan"
date: 2021-10-02
output: github_document
---

```{r setup, echo = FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
```

# Problem 1 

### Importing Mr.Trash Wheel Data. Mr.Trash Wheel is an Excel File. 
```{r importing data with specific requirements}
trashwheel_data <- 
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "Mr. Trash Wheel",
    range = "A2:N408",
    n_max = 20)
```

### Cleaning Mr.Trash Wheel Data
```{r cleaning data}
trashwheel_data <-
    trashwheel_data %>%
    janitor::clean_names() 
```

### Using filter, mutate, as.integer to get specific data from Mr.Trash Wheel data
```{r getting specific data from Mr.Trash Wheel data by using filter, mutate, as.integer}
trashwheel_data <-
  trashwheel_data %>%
  filter(!is.na(dumpster), month != "Grand Total") %>%
  mutate(sports_balls = as.integer(round(sports_balls, digits = 0)))
```


### Importing 2018 Precipitation Data. 2018 Precipitation is an Excel File. 
```{r importing 2018 Precipitation data with specific requirements}
precipitation18_data <-
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2018 Precipitation",
    range = "A2:B15",
    n_max = 20)
```


### Cleaning 2018 Precipitation Data.
```{r cleaning 2018 precipitation data}
precipitation18_data <-
  precipitation18_data %>%
  janitor::clean_names() %>%
  mutate(year = "2018") %>%
  #replace_na(list(month = "Total")) %>%
  drop_na()
```

### Importing 2019 Precipitation Data. 2019 Precipitation is an Excel File, 
```{r importing 2019 Precipitation data with specific requirements}
precipitation19_data <-
  read_excel(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2019 Precipitation",
    range = "A2:B15",
    n_max = 20)
```

### Cleaning 2019 Precipitation Data.
```{r cleaning 2019 precipitation data}
precipitation19_data <-
  precipitation19_data %>%
  janitor::clean_names() %>%
  mutate(year = "2019") %>%
  #replace_na(list(month = "Total")) %>%
  drop_na()
```


### Combining 2018 and 2019 Precipitation Data. Use bind_rows instead of r.bind. Never use r.bind. 
```{r combining data}
precipitation_data <-
  bind_rows(precipitation18_data, precipitation19_data) %>%
  mutate(month = month.name[month]) %>%
  relocate(year, month, total) %>%
  knitr::kable()

precipitation_data
```


# Problem 2

### Importing and cleaning the FiveThirtyEight Data. 
```{r}
pol_data <- 
  read_csv("./fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
  separate(col = mon, into = c("year","month", "day")) %>%
  mutate(across(.cols = c(year, month, day), as.integer)) %>%
  mutate(month = month.name[month]) %>%
  mutate(president = case_when(prez_dem == 1 ~ "dem", 
                               prez_gop == 1 ~ "gop",
                               prez_gop == 2 ~ "gop")) %>%
  select(year, month, president, everything(), -day, -prez_dem, -prez_gop)

pol_data
```

### Importing and cleaning the snp - Stock Market Data.
```{r}
stockmark_data <-
  read_csv("./fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names() %>%
  separate(col = date, into = c("month", "day", "year")) %>%
  mutate(across(.cols = c(year, month, day), as.integer)) %>%
  mutate(month = month.name[month]) %>%
  select(year, month, stockmarket_index = close)

stockmark_data
```

### Importing and cleaning the unemployment Data.
```{r}
unemploy_data <-
  read_csv("./fivethirtyeight_datasets/unemployment.csv") %>%
  janitor::clean_names() %>%
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "percentage"
  ) %>%
  mutate(across(.col = c(year), as.integer)) %>%
  mutate(month = recode(month, "jan" = "January", "feb" = "February", "mar" = "March", "apr" = "April", "may" = "May", "jun" = "June",                                "jul" = "July", "aug" = "August", "sep" = "September", "oct" = "October", "nov" = "November", "dec" =                                  "December"))
unemploy_data
```


###Combining the Poll and Stock Market Data by using left join. 
```{r}
merge_data1 <-
  left_join(pol_data, stockmark_data, by = c("year", "month"))
```



###Combining the newly constructed data (merged_data1) with the umeployment data. 
```{r}
merge_data2 <-
  left_join(merge_data1, unemploy_data, by = c("year", "month"))
view(merge_data2)
```
